{%- comment -%}  not very clean but it works  {%- endcomment -%}
{%- assign blog = blogs[section.settings.blog] -%}
{%- assign handle = handle -%}  
{%- assign handle_complete = 'guide/' | append: handle  -%}



{% if article.metafields.custom.article_related_1 != blank %}
    {%- assign metafield_1 = article.metafields.custom.article_related_1  -%}
    {%- assign handle_metafield_1 = 'guide/' | append: metafield_1  -%}
{% endif %}

{% if article.metafields.custom.article_related_2 != blank %}
    {%- assign metafield_2 = article.metafields.custom.article_related_2  -%}
    {%- assign handle_metafield_2 = 'guide/' | append: metafield_2  -%}
{% endif %}

{% if article.metafields.custom.article_related_3 != blank %}
    {%- assign metafield_3 = article.metafields.custom.article_related_3  -%}
    {%- assign handle_metafield_3 = 'guide/' | append: metafield_3  -%}
{% endif %}

{% if article.metafields.custom.article_related_4 != blank %}
    {%- assign metafield_4 = article.metafields.custom.article_related_4  -%}
    {%- assign handle_metafield_4 = 'guide/' | append: metafield_4  -%}
{% endif %}


{%- assign number_article = 0 -%}

<div class="mt-10 md:w-11/12 max-w-screen-xl md:mx-auto md:mt-[50px]">
  <h2 class="leading-[30px] mx-10 text-center uppercase">{{ section.settings.heading }}</h2>
  {% paginate blog.articles by 500 %}
    {% assign countItem = 0 %}
    <div class="mt-10 my-10">
       <div class="hidden md:flex md:flex-wrap">
        {% for article in blog.articles %}
              {%- assign article_handle = article.handle -%}
              {% if article_handle == handle_metafield_1 %}
                  {%- assign number_article = number_article | plus: 1 -%}
                    {%- assign article_meta = article -%}
                    
                      <div class="w-1/2 lg:w-1/4 block snap-start px-4 mb-6">
                          {% render 'article-card', blog: section.settings.blog, article: article_meta, show_image: section.settings.show_image, show_date: section.settings.show_date, show_author: section.settings.show_author, show_author: section.settings.show_author, show_button: section.settings.show_button, show_tag: section.settings.show_tag, show_date: section.settings.show_date, show_button: section.settings.show_button  %}  
                        </div>
              {% endif %}   

            {% if article_handle == handle_metafield_2 %} 
             {%- assign number_article = number_article | plus: 1 -%} 
              {%- assign article_meta_2 = article -%}
                
                <div class="w-1/2 lg:w-1/4 block snap-start px-4 mb-6">
                  {% render 'article-card', blog: section.settings.blog, article: article_meta_2, show_image: section.settings.show_image, show_date: section.settings.show_date, show_author: section.settings.show_author, show_author: section.settings.show_author, show_button: section.settings.show_button, show_tag: section.settings.show_tag, show_date: section.settings.show_date, show_button: section.settings.show_button  %}
                </div>
            {% endif %}  

            {% if article_handle == handle_metafield_3 %}  
             {%- assign number_article = number_article | plus: 1 -%}
             {%- assign article_meta_3 = article -%}
               
                 <div class="w-1/2 lg:w-1/4 block snap-start px-4 mb-6">
                   {% render 'article-card', blog: section.settings.blog, article: article_meta_3, show_image: section.settings.show_image, show_date: section.settings.show_date, show_author: section.settings.show_author, show_author: section.settings.show_author, show_button: section.settings.show_button, show_tag: section.settings.show_tag, show_date: section.settings.show_date, show_button: section.settings.show_button  %}
                  </div>
            {% endif %} 
            
           
            {% if article_handle == handle_metafield_4 %}  
             {%- assign number_article = number_article | plus: 1 -%}
             {%- assign article_meta_4 = article -%}
               
                 <div class="w-1/2 lg:w-1/4 block snap-start px-4 mb-6">
                   {% render 'article-card', blog: section.settings.blog, article: article_meta_4, show_image: section.settings.show_image, show_date: section.settings.show_date, show_author: section.settings.show_author, show_author: section.settings.show_author, show_button: section.settings.show_button, show_tag: section.settings.show_tag, show_date: section.settings.show_date, show_button: section.settings.show_button  %}
                  </div>
            {% endif %}  
        {% endfor %}
        
      
      </div>
      <!-- mobile-->
      <div class="flex md:hidden relative overflow-hidden overflow-x-scroll snap-mandatory snap-x ml-5 gap-4 scroller"> 
              {% for article in blog.articles %}
                
                {%- assign article_handle = article.handle -%}
                {% if article_handle == handle_metafield_1 %}
                    {%- assign number_article = number_article | plus: 1 -%}
                      {%- assign article_meta = article -%}
                      
                        <div class="min-w-[250px]">
                            {% render 'article-card', blog: section.settings.blog, article: article_meta, show_image: section.settings.show_image, show_date: section.settings.show_date, show_author: section.settings.show_author, show_author: section.settings.show_author, show_button: section.settings.show_button, show_tag: section.settings.show_tag, show_date: section.settings.show_date, show_button: section.settings.show_button  %}  
                          </div>
                {% endif %}   

              {% if article_handle == handle_metafield_2 %} 
              {%- assign number_article = number_article | plus: 1 -%} 
                {%- assign article_meta_2 = article -%}
                  
                  <div class="min-w-[250px]">
                    {% render 'article-card', blog: section.settings.blog, article: article_meta_2, show_image: section.settings.show_image, show_date: section.settings.show_date, show_author: section.settings.show_author, show_author: section.settings.show_author, show_button: section.settings.show_button, show_tag: section.settings.show_tag, show_date: section.settings.show_date, show_button: section.settings.show_button  %}
                  </div>
              {% endif %}  

              {% if article_handle == handle_metafield_3 %}  
              {%- assign number_article = number_article | plus: 1 -%}
              {%- assign article_meta_3 = article -%}
                
                  <div class="min-w-[250px]">
                    {% render 'article-card', blog: section.settings.blog, article: article_meta_3, show_image: section.settings.show_image, show_date: section.settings.show_date, show_author: section.settings.show_author, show_author: section.settings.show_author, show_button: section.settings.show_button, show_tag: section.settings.show_tag, show_date: section.settings.show_date, show_button: section.settings.show_button  %}
                    </div>
              {% endif %} 
              
            
              {% if article_handle == handle_metafield_4 %}  
              {%- assign number_article = number_article | plus: 1 -%}
              {%- assign article_meta_4 = article -%}
                
                  <div class="min-w-[250px]">
                    {% render 'article-card', blog: section.settings.blog, article: article_meta_4, show_image: section.settings.show_image, show_date: section.settings.show_date, show_author: section.settings.show_author, show_author: section.settings.show_author, show_button: section.settings.show_button, show_tag: section.settings.show_tag, show_date: section.settings.show_date, show_button: section.settings.show_button  %}
                    </div>
              {% endif %} 

          {% endfor %}
      </div>
      {% endpaginate %} 
    </div>
  </div>
<style>
    .scroller::-webkit-scrollbar {
      display: none;
    }
  </style>
{% schema %}
{
  "name": "Featured-blog metafields",
  "tag": "section",
  "settings": [
    {
      "id": "blog",
      "type": "blog",
      "label": "Choix du blog"
    },
    {
      "type": "header",
      "content": "Header"
    },
    {
      "type": "text",
      "id": "heading",
      "default": "À LIRE...",
      "label": "Titre"
    },
    {
      "type": "header",
      "content": "Grille d'articles"
    },
    {
      "type": "range",
      "id": "post_limit",
      "min": 4,
      "max": 12,
      "step": 1,
      "default": 4,
      "label": "Nombre d'articles de blog à afficher en desktop"
    },
    {
      "type": "header",
      "content": "Contenu des articles"
    },
    {
      "type": "checkbox",
      "id": "show_date",
      "default": false,
      "label": "Afficher la date"
    },
    {
      "type": "checkbox",
      "id": "show_author",
      "default": false,
      "label": "Afficher l'auteur"
    },
    {
      "type": "checkbox",
      "id": "show_button",
      "default": true,
      "label": "Afficher le bouton"
    }
  ],
  "presets": [
    {
      "name": "Featured-blog metafields",
      "settings": {
        "blog": "Main Blog"
      }
    }
  ]
}
{% endschema %}